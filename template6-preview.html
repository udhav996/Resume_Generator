<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- Use device width; scaling handled by JS so we keep zoom available for users -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Template 6 — Resume</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* Prevent OS/browser font auto-adjust */
    html, body { -webkit-text-size-adjust:100%; -ms-text-size-adjust:100%; text-size-adjust:100%; }

    body {
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      font-family: 'Lato', sans-serif;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }

    /* Wrapper centers and allows scrolling if necessary */
    .resume-wrapper {
      width: 100%;
      display: flex;
      justify-content: center;
      overflow-x: auto; /* allow horizontal pan if extremely small viewport */
      padding: 10px 0;
    }

    /* Fixed "canvas" width that mirrors desktop. We'll scale this element via JS. */
    .resume {
      width: 750px;
      background: #fff;
      border-radius: 40px;
      box-shadow: 0 0 15px rgba(0,0,0,0.12);
      overflow: visible;
      transform-origin: top left;
      /* base font size for consistent proportions */
      font-size: 13px;
      color: #222;
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      gap: 18px;
      padding: 20px;
      background: #f886b4;
      border-radius: 0 0 80px 0;
    }
    .header img {
      width: 110px;
      height: 130px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #fff;
      flex-shrink: 0;
    }
    .header-info h1 {
      margin:0;
      font-size: 26px;   /* heading bigger than body */
      font-weight:700;
      color:#222;
    }
    .header-info p {
      margin:4px 0;
      font-size: 14px;
      color:#333;
    }
    .header-info i { margin-right: 8px; width:16px; text-align:center; color:#444; }

    /* Grid layout */
    .container {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.8fr);
      gap: 50px;
      padding: 30px;
    }
    .container > div { min-width: 0; } /* allow columns to shrink */

    .section { margin-bottom: 24px; }
    .section h2 {
      display:flex;
      align-items:center;
      gap:10px;
      margin:0 0 10px;
      font-size: 18px;   /* clearly larger than list text */
      font-weight:600;
      color:#222;
      border-bottom:2px solid #eee;
      padding-bottom:6px;
    }
    .section h2 i { color:#ef84c3; }

    .section ul { list-style:none; padding-left:0; margin:0; }
    .section li {
      margin-bottom:8px;
      font-size: 13px;  /* subpoint size */
      line-height:1.6;
      overflow-wrap:anywhere;
    }
    .section p { font-size:13px; line-height:1.6; margin:0 0 8px 0; }

    /* bullet symbol for lists */
    .section ul li::before { content: "▸"; margin-right:8px; color:#f575cf; font-weight:700; display:inline-block; width:16px; }

    /* Wrapping protections */
    .left, .right, .section, .section li, .header-info p {
      word-break: break-word;
      overflow-wrap: anywhere;
      white-space: normal;
      min-width: 0;
    }

    /* small-screen adjustments for spacing only; final visual size is controlled by JS scaling */
    @media (max-width: 420px) {
      .container { gap: 30px; padding: 18px; }
      .header { gap: 12px; padding: 14px; }
      .header img { width:96px; height:110px; }
    }

    /* print */
    @media print {
      body { padding:0; background: #fff; }
      .resume { box-shadow:none; border-radius:0; }
    }
  </style>
</head>
<body>

  <div style="display:flex; flex-direction:column; align-items:center; width:100%;">
    <button id="downloadBtn" style="margin:10px auto 18px; padding:10px 18px; background:#f989ba; color:#fff; border:none; border-radius:8px; cursor:pointer;">
      Download PDF
    </button>

    <div class="resume-wrapper">
      <div class="resume" id="resume">
        <!-- Header -->
        <div class="header">
          <img id="profilePhoto" src="" alt="Profile Photo">
          <div class="header-info">
            <h1 id="displayName">Your Name</h1>
            <p id="phoneItem"><i class="fas fa-phone"></i> <span id="phoneDisplay"></span></p>
            <p id="emailItem"><i class="fas fa-envelope"></i> <span id="emailDisplay"></span></p>
            <p id="portfolioItem"><i class="fas fa-globe"></i> <span id="portfolioDisplay"></span></p>
            <p id="linkedinItem"><i class="fab fa-linkedin"></i> <span id="linkedinDisplay"></span></p>
            <p id="githubItem"><i class="fab fa-github"></i> <span id="githubDisplay"></span></p>
          </div>
        </div>

        <!-- Content -->
        <div class="container">
          <div class="left">
            <div class="section" id="summarySection">
              <h2><i class="fas fa-user"></i> Summary</h2>
              <p id="summaryDisplay"></p>
            </div>

            <div class="section" id="skillsSection">
              <h2><i class="fas fa-laptop-code"></i> Tech Skills</h2>
              <ul id="skillsDisplay"></ul>
            </div>

            <div class="section" id="languagesSection">
              <h2><i class="fas fa-language"></i> Languages</h2>
              <ul id="languagesDisplay"></ul>
            </div>

            <div class="section" id="interestsSection">
              <h2><i class="fas fa-heart"></i> Interests</h2>
              <ul id="interestsDisplay"></ul>
            </div>
          </div>

          <div class="right">
            <div class="section" id="otherSkillsSection">
              <h2><i class="fas fa-cogs"></i> Other Skills</h2>
              <ul id="otherSkillsDisplay"></ul>
            </div>

            <div class="section" id="experienceSection">
              <h2><i class="fas fa-briefcase"></i> Experience</h2>
              <ul id="experienceDisplay"></ul>
            </div>

            <div class="section" id="projectsSection">
              <h2><i class="fas fa-tasks"></i> Projects</h2>
              <ul id="projectsDisplay"></ul>
            </div>

            <div class="section" id="certificationsSection">
              <h2><i class="fas fa-certificate"></i> Certifications</h2>
              <ul id="certificationsDisplay"></ul>
            </div>

            <div class="section" id="achievementsSection">
              <h2><i class="fas fa-award"></i> Achievements</h2>
              <ul id="achievementsDisplay"></ul>
            </div>

            <div class="section" id="educationSection">
              <h2><i class="fas fa-graduation-cap"></i> Education</h2>
              <ul id="educationDisplay"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
<script>
  // ---------- Scaling logic: fits .resume into viewport while keeping perfect proportions ----------
  const RESUME_WIDTH = 750; // px (desktop canvas width)

  function applyScale() {
    const resume = document.getElementById('resume');
    const wrapper = document.querySelector('.resume-wrapper');
    if (!resume || !wrapper) return;

    // available width inside wrapper (leave small margin)
    const viewportWidth = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    const margin = 24; // px margin left+right
    const available = Math.max(320, viewportWidth - margin);

    // compute scale <= 1
    const scale = Math.min(1, available / RESUME_WIDTH);

    // apply transform
    resume.style.transform = `scale(${scale})`;
    // Adjust wrapper height so page length still scrolls properly (so the scaled box doesn't clip)
    const naturalHeight = resume.getBoundingClientRect().height / scale; // original height (approx)
    wrapper.style.height = (naturalHeight * scale) + 'px';
    wrapper.style.paddingBottom = '20px';
  }

  // recalc on load / resize / orientation change
  window.addEventListener('load', () => {
    populateResume();   // populate then scale
    setTimeout(applyScale, 30); // small delay so fonts/images can load
  });
  window.addEventListener('resize', () => requestAnimationFrame(applyScale));
  window.addEventListener('orientationchange', () => setTimeout(applyScale, 120));

  // ---------- populateResume (same style as your other templates) ----------
  function populateResume() {
    const params = new URLSearchParams(window.location.search);
    const setText = (id, val) => { if (val) document.getElementById(id).textContent = val; };

    const formatList = (text) => !text ? [] : text.split(/\n/).map(l => l.trim()).filter(Boolean).map(l => `<li>${l}</li>`);
    const formatPairs = (text) => !text ? [] : text.split(/\n/).map(l => l.trim()).filter(Boolean).map(l => {
      const parts = l.split("-");
      return parts.length > 1 ? `<li><strong>${parts[0].trim()}</strong> – ${parts.slice(1).join("-").trim()}</li>` : `<li>${l}</li>`;
    });
    const fillList = (id, data, sectionId) => {
      if (data && data.length) document.getElementById(id).innerHTML = data.join('');
      else document.getElementById(sectionId).style.display = "none";
    };

    // photo from sessionStorage (works better on mobile)
    let photo = sessionStorage.getItem("resumePhoto");
    if (photo) document.getElementById("profilePhoto").src = photo;

    // header info
    setText('displayName', params.get('fullName'));
    if (params.get('phone')) setText('phoneDisplay', params.get('phone')); else document.getElementById('phoneItem').style.display = "none";
    if (params.get('email')) setText('emailDisplay', params.get('email')); else document.getElementById('emailItem').style.display = "none";
    if (params.get('portfolio')) setText('portfolioDisplay', params.get('portfolio')); else document.getElementById('portfolioItem').style.display = "none";
    if (params.get('linkedin')) setText('linkedinDisplay', params.get('linkedin')); else document.getElementById('linkedinItem').style.display = "none";
    if (params.get('github')) setText('githubDisplay', params.get('github')); else document.getElementById('githubItem').style.display = "none";

    // summary
    const summary = params.get('summary');
    if (summary) document.getElementById('summaryDisplay').innerHTML = summary.replace(/\n/g, "<br>");
    else document.getElementById('summarySection').style.display = "none";

    // lists
    fillList('skillsDisplay', formatList(params.get('skills')), 'skillsSection');
    fillList('otherSkillsDisplay', formatList(params.get('otherSkills')), 'otherSkillsSection');
    fillList('educationDisplay', formatPairs(params.get('education')), 'educationSection');
    fillList('experienceDisplay', formatPairs(params.get('experience')), 'experienceSection');
    fillList('projectsDisplay', formatPairs(params.get('projects')), 'projectsSection');
    fillList('certificationsDisplay', formatList(params.get('certifications')), 'certificationsSection');
    fillList('achievementsDisplay', formatList(params.get('achievements')), 'achievementsSection');
    fillList('languagesDisplay', formatList(params.get('languages')), 'languagesSection');
    fillList('interestsDisplay', formatList(params.get('interests')), 'interestsSection');

    // once content is placed, apply scale
    setTimeout(applyScale, 40);
  }

  // ---------- PDF export: temporarily remove scale so exported PDF uses full-resolution canvas ----------
  async function downloadPDF() {
    const resume = document.getElementById('resume');
    if (!resume) return alert('Resume not found');

    // save current transform
    const prevTransform = resume.style.transform;
    // temporarily unscale (so html2pdf captures at full 750px width)
    resume.style.transform = 'none';

    // small delay to allow repaint
    await new Promise(r => setTimeout(r, 60));

    const params = new URLSearchParams(window.location.search);
    const pdfSize = params.get('pdfSize') || 'a4';
    const opt = {
      margin: 0,
      filename: 'resume.pdf',
      image: { type: 'jpeg', quality: 1 },
      html2canvas: { scale: 2, useCORS: true, allowTaint: true, scrollX: 0, scrollY: 0 },
      jsPDF: { unit: 'pt', format: pdfSize, orientation: 'portrait' }
    };

    try {
      await html2pdf().set(opt).from(resume).save();
    } catch (err) {
      console.error('PDF error', err);
      alert('PDF export failed — see console for details');
    } finally {
      // restore transform and reapply scale for preview
      resume.style.transform = prevTransform;
      setTimeout(applyScale, 40);
    }
  }

  document.getElementById('downloadBtn').addEventListener('click', downloadPDF);
</script>
</body>
</html>
